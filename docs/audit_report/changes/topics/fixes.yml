title: Fixes

description: |
  This section lists fixes on various topics.
  Note that there's a dedicated section for :ref:`fixes related to X.509 <changes/fixes_x509>`.

  Notable fixes are a missing reduction in the ECDSA signature computation, an
  unexpected result of the auto-tuning of scrypt2 parameters, and a potential
  use-after-free in the command line interface.

patches:
# Fix test_cli_crypt.py with --threads=1 [ci skip]  (Jack Lloyd)
- commit: 187e3d8dc62e3d935cb480f8a6140abb9b3aaa7b  # https://github.com/randombit/botan/commit/187e3d8dc62e3d935cb480f8a6140abb9b3aaa7b
  classification: info
  auditer: FAlbertDev

# Fix curve448 compiler warning  (@FAlbertDev)
- pr: 4025  # https://github.com/randombit/botan/pull/4025
  merge_commit: bf86f1a9f99aa1fc62f9884d0bda8193fb1d57b7
  classification: info

# Correct an error in RFC 6979 ECDSA  (@randombit)
- pr: 4040  # https://github.com/randombit/botan/pull/4040
  merge_commit: adda2dd9f7799d2c64a5541c3733e47213b57bd1
  classification: relevant
  auditer: FAlbertDev
  comment: |
    Fixes a bug where the ECDSA message hash was not reduced modulo the EC group order
    before being used in the signature computation. Due to the math involved, this
    does not produce wrong results, but RFC 6979 asks for it. Also, this fix now
    disallows ECDSA private keys that were not reduced beforehand. The tests were
    adjusted accordingly.


# fixed retransmission handled ClientHello with another protocol version.  (@volok-aleksej)
- pr: 4037  # https://github.com/randombit/botan/pull/4037
  merge_commit: 8798305c102934c4c20d9e4f63b768ba7e74c6b9
  classification: relevant
  auditer: FAlbertDev
  comment: |
    Fixes a DTLS 1.2 bug that terminates a connection if ClientHello records
    are retransmitted.

# Improve FFI's botan_cipher_update() performance for stream ciphers  (@reneme)
- pr: 3951  # https://github.com/randombit/botan/pull/3951
  merge_commit: 1644599e16f6b128c4caf32fb0eca6e67394bfe9
  classification: relevant

# Doc: botan_cipher_update() byte generation behavior  (@reneme)
- pr: 4088  # https://github.com/randombit/botan/pull/4088
  merge_commit: 908dfde29b634a76119af43a08bb3c5354de6273
  classification: info

# Fix some possible iterator debugging errors in TLS-CBC  (@randombit)
- pr: 4131  # https://github.com/randombit/botan/pull/4131
  merge_commit: d6b35ca693ff855fc84da37c1d08f23a2c762320
  classification: info

# FIX: store_be(size_t(42)) would not compile on Xcode  (@reneme)
- pr: 4126  # https://github.com/randombit/botan/pull/4126
  merge_commit: 9066d9c9b01e8eca5932dc0b6eeb3cd7fb2468a9
  classification: info

# PBES2 improvements and fix PBES2-related scrypt bug  (@randombit)
- pr: 4118  # https://github.com/randombit/botan/pull/4118
  merge_commit: f02c6027b19f3e992796c157a474720ed3bcf82a
  classification: relevant
  comment: |
    The automatic parameter tuning for scrypt2 might have yielded a smaller
    memory consumption factor than intended. Also, include the key length in the
    PBES2 container encoding only if the used cipher does not define it.

# Properly mask the carry bit in word_add  (@randombit)
- pr: 4153  # https://github.com/randombit/botan/pull/4153
  merge_commit: 92c2079134bc7af7c5ffd1f8b7a69afa45db14fc
  classification: info

# Fix CodeQL multiplication overflow warnings  (@randombit)
- pr: 4166  # https://github.com/randombit/botan/pull/4166
  merge_commit: b8735b152ae7cf1379a661370854044c512d3dcd
  classification: info
  auditer: reneme

# FIX: Better scaling for botan_cipher_get_update_granularity()  (@reneme)
- pr: 4122  # https://github.com/randombit/botan/pull/4122
  merge_commit: d9ea5a82b74c3f0f0440d39d14fe30b714c7e01c
  classification: info

# FIX: Race conditions in `test_cli.py` when spawning test server processes  (@reneme)
- pr: 4178  # https://github.com/randombit/botan/pull/4178
  merge_commit: 3e65302e8159fb7e4a835ef69bab9bddbaa7183c
  classification: info
  comment: |
    Race conditions were in the steering of the test, not in the shipped code.

# FIX: potential use-after-free in `./botan tls_proxy`  (@reneme)
- pr: 4177  # https://github.com/randombit/botan/pull/4177
  merge_commit: a75bb25ff7311a47202908ba3e165e19b460a431
  classification: relevant
  comment: |
    The use-after-free was in the command line interface, specifically in the
    ``./botan tls_proxy`` command. This command is shipped in Botan's CLI but
    we don't expect that end-users will actually use it in production as it is
    more of a testing tool.
