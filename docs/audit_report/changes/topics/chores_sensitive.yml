title: Code Improvements on Sensitive Code

description: |
  Similarly to :ref:`changes/chores`, this contains generic improvements to
  the code base. However, these changes significantly modify code that is
  directly relevant for the security of the library.

  Most notably, this replaces legacy buffer handling with more modern helper
  constructions to improve readability and general memory safety.

patches:
# Move const time memory comparison utils to ct_utils.h  (@randombit)
- pr: 3760  # https://github.com/randombit/botan/pull/3760
  merge_commit: 4c6612c3a4179dad774afa85f04925703418563c
  classification: relevant
  auditer: reneme
  comment: |
    Code for constant time comparison of buffers was slightly adapted and
    refactored, downstream usage locations were adapted accordingly. Some code
    duplication and inconsistencies were removed in the process.

# Use BufferStuffer in pk_pad  (@randombit)
- pr: 3753  # https://github.com/randombit/botan/pull/3753
  merge_commit: 4ea66d2c21793f6cbbefce6b8d633dc42272fc2c
  classification: relevant
  comment: |
    Improves the readability and memory safety of several public key padding
    schemes by replacing C-style marshalling code with a C++ helper class that
    incorporates bounds checks and hides the complexity of buffer offset
    calculations.

# Remove use of buffer_insert from filters, MACs, stream ciphers  (@randombit)
- pr: 3757  # https://github.com/randombit/botan/pull/3757
  merge_commit: 380b3ca21b0d0f98f853993ade9d6c829156a54a
  classification: relevant

# Use concat in DLIES and ECIES  (@randombit)
- pr: 3756  # https://github.com/randombit/botan/pull/3756
  merge_commit: dce57381e0730aa2b902f0793ca4dc46e0add036
  classification: relevant
