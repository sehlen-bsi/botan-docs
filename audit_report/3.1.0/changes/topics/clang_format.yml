title: Clang Format

description: |
  This section is about the introduction of clang-format to Botan. Since Botan
  used a different format style before, the entire codebase is reformatted for
  the newest version. Also, for each change in the .clang-format file, the codebase
  is reformatted again. These commits produce a very large diff.
  For this audit, we verify the respective commits by checking out the commit
  before, executing clang-format, and comparing the new state with the commit result
  we investigate. This ensures that the logic is not touched by these commits.


patches:
# Change AllowShortFunctionsOnASingleLine from All to Inline  (@randombit)
- pr: 3584  # https://github.com/randombit/botan/pull/3584
  merge_commit: 96fe3b96d88a24eaceb6c5e14f15b77f816b339f
  classification: info
  auditer: FAlbertDev
  comment: |
    Change AllowShortFunctionsOnASingleLine in .clang-format from All to Inline and
    apply this change to the code base. We use the verification strategy
    described above.


# In run_clang_format.py, start formatting os_utils.cpp right away  (@randombit)
- pr: 3574  # https://github.com/randombit/botan/pull/3574
  merge_commit: 57e400802b219376dd0bd0e0eec1e3b625964468
  classification: info
  auditer: FAlbertDev

# Configure VSCode for clangd and clang-format  (@reneme)
- pr: 3563  # https://github.com/randombit/botan/pull/3563
  merge_commit: 58109ff6ad4db5911003f0eaf9262bf02da3c99c
  classification: info

# Change clang-format AllowShortBlocksOnASingleLine from true to Empty  (@randombit)
- pr: 3568  # https://github.com/randombit/botan/pull/3568
  merge_commit: be0b24f78c4ffbf1fa306df07c60abea67d2cac2
  classification: info
  auditer: FAlbertDev
  comment: |
    Change clang-format AllowShortBlocksOnASingleLine in .clang-format
    from true to Empty and apply this change to the code base. We use
    the verification strategy described above.


# Add braces around all if/else statements  (@randombit)
- pr: 3558  # https://github.com/randombit/botan/pull/3558
  merge_commit: a84a385ea8438545d0e2a55646d48138be7b5801
  classification: info
  auditer: FAlbert

# Update the codegen scripts to output clang-format compatible output  (@randombit)
- pr: 3559  # https://github.com/randombit/botan/pull/3559
  merge_commit: 5b8077004438ed9bf8f9118e7f1f3c65f5466ba8
  classification: info
  auditer: FAlbertDev

# Apply clang-format to the codebase  (@randombit)
- pr: 3502  # https://github.com/randombit/botan/pull/3502
  merge_commit: b538e89fc209be88c733c54f7eb5179d4c002d39
  classification: info
  auditer: FAlbertDev
  comment: |
    Add a clang-format script, a .clang-format file, and corresponding documentation.
    Also, clang-format is applied to the codebase. We use the verification strategy described
    above.

# Include one newline after the main include in a source file  (@randombit)
- pr: 3507  # https://github.com/randombit/botan/pull/3507
  merge_commit: 8f71238392da9d7aba1f8823da87e13d47ac253c
  classification: info
  auditer: FAlbertDev

# Fix some funky formatting  (@Jack Lloyd)
- commit: 68aaa84bfaa2cd75a859b967f59a8f9905f9ed52  # https://github.com/randombit/botan/commit/68aaa84bfaa2cd75a859b967f59a8f9905f9ed52
  classification: info
  auditer: FAlbertDev
  comment: Reword a comment and move a bracket

# Use difflib to generate the diff if format check fails  (@Jack Lloyd)
- commit: 41f72675088f5e1370e50ba3f48f983d6b4c17fd  # https://github.com/randombit/botan/commit/41f72675088f5e1370e50ba3f48f983d6b4c17fd
  classification: info
  auditer: FAlbertDev

# Fix weird formatting in CAST-128  (@Jack Lloyd)
- commit: 16b3f8b2c68e2dea6ca7afd4548ffce56e99198d  # https://github.com/randombit/botan/commit/16b3f8b2c68e2dea6ca7afd4548ffce56e99198d
  classification: info
  auditer: FAlbertDev

# Fix clang-format fuckup  (@Jack Lloyd)
- commit: 155a72d50a791079d63123c2bc717663a727d4f4  # https://github.com/randombit/botan/commit/155a72d50a791079d63123c2bc717663a727d4f4
  classification: info
  auditer: FAlbertDev
  comment: Manually fix unwanted clang-format formatting

# Fix formatting weirdness in psk_db.h  (@Jack Lloyd)
- commit: 6cf5abeaf0d452d030f44f1de109c2fdbcc6bd54  # https://github.com/randombit/botan/commit/6cf5abeaf0d452d030f44f1de109c2fdbcc6bd54
  classification: info
  auditer: FAlbertDev
